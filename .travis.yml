language: node_js # Sets which engine use to build the project
node_js: "node" # Specifies node version to use "node"="latest"
env:
  NODE_ENV: "testing"
  MYSQL_DATABASE: testbase
  MYSQL_ROOT_PASSWORD: 
  sqlhost: localhost
  sqluser: travis
addons:
  apt:
    sources:
      - mysql-5.7-trusty
    packages:
      - mysql-server
      - mysql-client
service: mysql
cache:
  directories:
    - "node_modules"

before_script:
  - cp ./migrations/config.js.travis ./migrations/config.js
  - mysql -e "CREATE DATABASE IF NOT EXISTS testbase;"
script:
  - npm i -g codecov
  - npm run migrations
  - npm run coverage